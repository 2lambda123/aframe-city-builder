<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>A-Frame City Draw</title>
    <meta name="description" content="A-Frame City Draw">
    <!-- <script src="https://aframe.io/releases/0.3.1/aframe.min.js"></script> -->
    <script src="lib/aframe-3.1.min.js"></script>
    <script src="lib/aframe-extras.min.js"></script>
    <script src="lib/demo-controls.js"></script>
    <!-- <script src="https://rawgit.com/dbradleyfl/aframe-gridhelper/master/dist/aframe-gridhelper-component.min.js"></script> -->
    <script src="lib/aframe-gridhelper-component.min.js"></script>
    <script src="https://rawgit.com/bryik/aframe-vive-cursor-component/master/dist/aframe-vive-cursor-component.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>
  <body>
    <a-scene id="my-scene" antialias='true'>

      <a-assets>
        <a-mixin id="grid-cube" geometry="primitive: box; width: 0.50; height: 0.50; depth: 0.50"></a-mixin>
        <a-mixin id="grid-cube-hovered" material="color: magenta"></a-mixin>
        <a-mixin id="grid-cube-selected" material="color: cyan"></a-mixin>
        <a-mixin id="red" material="color: red; transparent: true; opacity: 0"></a-mixin>
        <a-mixin id="green" material="color: green"></a-mixin>
        <a-mixin id="blue" material="color: blue"></a-mixin>
        <a-mixin id="yellow" material="color: yellow"></a-mixin>

        <a-mixin id="highlight">
          <a-animation begin="mouseenter" attribute="material.opacity" from="0" to="0.5"></a-animation>
          <a-animation begin="mouseleave" attribute="material.opacity" from="0.5" to="0"></a-animation>
        </a-mixin>

        <a-asset-item id="veh_ambulance-obj" src="assets/veh_ambulance.obj"></a-asset-item>
        <a-asset-item id="veh_ambulance-mtl" src="assets/veh_ambulance.mtl"></a-asset-item>

        <a-asset-item id="base-street-obj" src="assets/plate-streetv1.obj"></a-asset-item>
        <a-asset-item id="base-street-mtl" src="assets/plate-streetv1.mtl"></a-asset-item>

        <a-asset-item id="base-cross-street-obj" src="assets/plate-cross-street.obj"></a-asset-item>
        <a-asset-item id="base-cross-street-mtl" src="assets/plate-cross-street.mtl"></a-asset-item>

        <a-asset-item id="base-grass-obj" src="assets/plate-grassv1.obj"></a-asset-item>
        <a-asset-item id="base-grass-mtl" src="assets/plate-grassv1.mtl"></a-asset-item>

        <a-asset-item id="table-obj" src="assets/mesa.obj"></a-asset-item>
        <a-asset-item id="table-mtl" src="assets/mesa.mtl"></a-asset-item>

      </a-assets>

      <!-- Player -->
      <a-entity id="camera" camera look-controls wasd-controls="fly: true" position="0 -0.5 0"></a-entity>

      <a-entity demo-controls id="leftController" wasd-controls vive-controls="hand: left" vive-cursor>
        <a-obj-model id="leftItem" baseid="1" src="#base-street-obj" mtl="#base-street-mtl" scale="0.01 0.01 0.01" position="0 0 -0.25" rotation="0 90 0"></a-obj-model>
      </a-entity>

      <a-entity demo-controls id="rightController" vive-controls="hand: right">
        <a-obj-model id="rightItem" src="#veh_ambulance-obj" mtl="#veh_ambulance-mtl" scale="0.005 0.005 0.005" position="0 0 -0.25" rotation="0 0 0"></a-obj-model>
      </a-entity>

      <!-- Table and Grid -->
      <a-entity id="tableGrid" position="0.25 0.5 0.25" gridhelper="step: 0.50; size: 5" >
        <a-box id="tableTop" position="0.12 -0.01 -1.02" width="3" height="0.1" depth="2" color="#09620b" material="color:#09620b" geometry="primitive:box;width:3;height:0.1;depth:2" scale="0.9 0.19999999999999996 0.78" visible="true"></a-box>
        <a-obj-model id="tableBase" src="#table-obj" mtl="#table-mtl" scale="0.015 0.015 0.015" position="0.18 -0.02 -1" rotation="0 0 0" material="" obj-model="obj:#mesa-obj;mtl:#mesa-mtl"></a-obj-model>
      </a-entity>

      <!-- Floor -->
      <a-entity id="floor" color="#603a2b" material="color:#603a2b" geometry="primitive: circle; radius: 2.5" position="0 0 0" rotation="-90 0 0" ></a-entity>

      <!-- Grid Boxes -->
      <!-- <a-entity id="grid-boxes">

        <script type="text/javascript">
        $( document ).ready(function() {

            var sceneEl = d3.select("#my-scene");

            var zeroX = -1.25;
            var zeroY = 0.25;
            var zeroZ = -2.25;

            var voxelSize = 0.5;

            var maxRows = 6;
            var maxColumns = 6;

            for ( var indexRow = 0; indexRow < maxRows; indexRow ++ ) {
              for ( var indexColumn = 0; indexColumn < maxColumns; indexColumn ++) {
                // <a-entity id="grid-x-y-z" mixin="grid-cube red" position="-0.25 0.25 -0.75">
                var position = (zeroX + indexRow * voxelSize) + ' ' + zeroY + ' ' + (zeroZ + indexColumn * voxelSize);
                console.log( "position: " + position );
                sceneEl.append('a-entity')
          	           .attr('id', 'grid-' + indexRow + '-0-0')
                       .attr('mixin', 'grid-cube red highlight collider')
          	           .attr('position', position);
              };
        	  };
        });
        </script>

        <a-entity id="grid-0-0-0" mixin="grid-cube red" position="-0.25 0.25 -0.75">
          <a-animation begin="mouseenter" attribute="material.opacity" from="0" to="0.5"
                       easing="linear" dur="1000" repeat="indefinite" direction="alternate"></a-animation>
          <a-animation begin="mouseleave" attribute="material.opacity" to="0"
                       easing="linear" dur="500" repeat="1" fill="forwards"></a-animation>

        </a-entity>

      </a-entity> -->


      <!-- Sky -->
      <a-sky color="#E0E0E0"></a-sky>


    </a-scene>
  </body>
</html>
